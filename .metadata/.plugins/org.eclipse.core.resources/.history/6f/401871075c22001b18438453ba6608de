package SalesRefundPositivecases;

import utility.Constant;
import java.io.IOException;
import java.sql.Driver;
import java.util.ArrayList;
import org.testng.annotations.AfterMethod;
import org.testng.annotations.BeforeMethod;
import org.testng.annotations.BeforeTest;
import org.testng.annotations.DataProvider;
import org.testng.annotations.Listeners;
import org.testng.annotations.Test;
import travlogix.Wrappermethods;
import atu.testng.reports.listeners.ATUReportsListener;
import atu.testng.reports.listeners.ConfigurationListener;
import atu.testng.reports.listeners.MethodListener;

@Listeners({ ATUReportsListener.class, ConfigurationListener.class, MethodListener.class })
public class Misccash {
	static {

		// System.setProperty("atu.reporter.config",
		// "C:\\ATUReports\\atu.properties");
		System.setProperty("atu.reporter.config", utility.Constant.ATUREPORTS);

	}

	Wrappermethods wm;

	@BeforeTest
	public void instantiation() {
		wm = new Wrappermethods();

	}

	@BeforeMethod
	public void browesrnstatiation()

	{

		wm.launchbrowser("chrome", utility.Constant.TRAVELOGIXURL);

	}

	@Test(dataProvider = "dp")
	public void logincheckK(String Username, String Password, String Leftsidemenu, String ActiveFrom1,
			String ActiveFrom2, String ActiveFrom3, String Docktype, String Docktypeindex, String Salesbracnh,
			String Salesbracnhindex, String Customer, String Customerindex, String Leadpaxnamee,
			String dktClientReference, String Tickectstatusindex,

			String Commonindex, String Servicetype, String Payableagent, String Bookingexecutive, String Salesexecutive,
			String Cityname, String Saledate1, String Saledate2, String Saledate3, String MiscConfirmationNumber,
			String MiscBookingReference, String Remarks, String Servicedetails, String Servicedetails1,
			
			String Processtype,String Currency,String MiscRateUnits,String MiscRateServiceRate,String Lodgecard,
			
			String MiscTaxAmount,String Servicecharge,String MiscServiceFeeAmount,String MiscRateCommPercent1,
			String MiscRateCommPercent2,String MiscRateDiscPercent1,String Agentincentive,String Customerdetails,
			
			String ProjectNumberAP,String DepartmentAP,String MajorClassAP,String TravelStatusAP,
			String TotalSavingCodeAP,String GroupTravelIndicatorAP,String TourCodeAP,String EndorsementRestrictAP,
			String FareCalculationAreaAP,String IntlSalesIndicatorAP

			
) throws Exception

	{

		Thread.sleep(2000);

		// wm.sendtextbyid("", );
		wm.sendtextbyid("LoginCode", Username);
		Thread.sleep(50);
		wm.sendtextbyid("Password", Password);
		Thread.sleep(50);
		wm.clickbyxpath("//input[@value='Login']");
		Thread.sleep(900);

		// screnn===========================================================
		wm.sendtextbyid("input-items", Leftsidemenu);
		Thread.sleep(500);
		wm.clickbyid("modCAS001");
		Thread.sleep(500);
		wm.clickbyid("pgmSAL001");
		wm.sleep();

		wm.clickbyid("btnMainAdd");

		Thread.sleep(2000);

		wm.sendtextbycssselecotr("#DktDate", "" + ActiveFrom1 + "-" + ActiveFrom2 + "-" + ActiveFrom3);

		// Dockett
		wm.sendtextbyxvalue("//input[@aria-owns='dktDocTypeCode_listbox']", Docktype);
		Thread.sleep(50);
		wm.Listandenter("//*[@id='dktDocTypeCode_listbox']/li", Docktypeindex);
		Thread.sleep(200);

		// Salesbranch
		wm.sendtextbyxvalue("//input[@aria-owns='DktBranchKey_listbox']", Salesbracnh);
		Thread.sleep(50);
		wm.Listandenter("//*[@id='DktBranchKey_listbox']/li", Salesbracnhindex);
		Thread.sleep(200);

		// customerr
		wm.sendtextbyxvalue("//input[@aria-owns='DktPartnername_listbox']", Customer);
		Thread.sleep(50);
		wm.Listandenter("//*[@id='DktPartnername_listbox']/li", Customerindex);
		Thread.sleep(200);

		wm.sendtextbycssselecotrwithoutclear("#dktLeadPaxName", "" + Leadpaxnamee);
		Thread.sleep(200);

		// clintrefecnce
		wm.sendtextbycssselecotrwithoutclear("#dktClientReference", "" + dktClientReference);
		Thread.sleep(200);

		wm.Listandenter("//i[@class='fa fa-chevron-down']", "3");
		Thread.sleep(200);
		wm.Listandenter("//i[@class='fa fa-plus']", "3");
		Thread.sleep(2500);

		// Enter the miscdetails

		wm.sendtextbyxvalue("//input[@aria-owns='MiscServiceType_listbox']", Servicetype);
		Thread.sleep(200);
		wm.Listandenter("//*[@id='MiscServiceType_listbox']/li", Commonindex);
		Thread.sleep(200);

		// payableagent

		wm.sendtextbyxvalue("//input[@aria-owns='MiscPayableAgentKey_listbox']", Payableagent);
		Thread.sleep(200);
		wm.Listandenter("//*[@id='MiscPayableAgentKey_listbox']/li", Commonindex);
		Thread.sleep(200);

		// Bookingexecutive
		wm.sendtextbyxvalue("//input[@aria-owns='MiscBookingExecutieveName_listbox']", Bookingexecutive);
		Thread.sleep(200);
		wm.Listandenter("//*[@id='MiscBookingExecutieveName_listbox']/li", Commonindex);
		Thread.sleep(200);

		// sales exectivee
		wm.sendtextbyxvalue("//input[@aria-owns='MiscSalesExecutiveName_listbox']", Salesexecutive);
		Thread.sleep(200);
		wm.Listandenter("//*[@id='MiscSalesExecutiveName_listbox']/li", Commonindex);
		Thread.sleep(200);

		// enter thecityname
		wm.sendtextbyxvalue("//input[@aria-owns='MiscCityName_listbox']", Cityname);
		Thread.sleep(200);
		wm.Listandenter("//*[@id='MiscCityName_listbox']/li", Commonindex);
		Thread.sleep(200);

		// datee

		wm.sendtextbycssselecotr("#MiscServicetktDate", "" + Saledate1 + "-" + Saledate2 + "-" + Saledate3);
		Thread.sleep(200);

		// confirmationnumber
		wm.sendtextbycssselecotrwithoutclear("#MiscConfirmationNumber", MiscConfirmationNumber);
		Thread.sleep(90);

		// boking refernece
		wm.sendtextbycssselecotrwithoutclear("#MiscBookingReference", MiscBookingReference);
		Thread.sleep(90);

		wm.sendtextbycssselecotrwithoutclear("#Remarks", Remarks);
		Thread.sleep(90);

		// Enter theservicedetails

		wm.Sendtextwhenduplicateproperty("//input[@name='MiscHtlInternationalDomestic']", "0", Servicedetails);
		Thread.sleep(90);

		wm.Sendtextwhenduplicateproperty("//input[@name='MiscHtlInternationalDomestic']", "1", Servicedetails1);
		Thread.sleep(90);
		wm.clickbyxpath("//*[@id='IdSAMiscDynamicServiceDetailsDiv']/div/div/div[1]/div[1]/a/i");
		Thread.sleep(200);
		
//Enter the faredetails

		//processtypee
		wm.sendtextbyxvalue("//input[@aria-owns='MisctfdProcessTypeKey_listbox']",Processtype);
		Thread.sleep(90);
		wm.Listandenter("//*[@id='MisctfdProcessTypeKey_listbox']/li", Commonindex);
		Thread.sleep(200);

		//Currecydetails 
		wm.sendtextbyxvalue("//input[@aria-owns='MiscRateCurrencyKey_listbox']",Currency);
		Thread.sleep(90);
		wm.Listandenter("//*[@id='MiscRateCurrencyKey_listbox']/li", Commonindex);
		Thread.sleep(200);
		
		//unit
	wm.sendtextbycssselecotr("#MiscRateUnits", ""+MiscRateUnits);
	Thread.sleep(200);
	
	wm.stabbyxpath("//input[@name='MiscRateServiceRate']");
	Thread.sleep(100);
	
	
	wm.sendtextbyxvalue("//input[@name='MiscRateServiceRate']",""+MiscRateServiceRate+".00");
	
	//wm.sendtextbycssselecotrwithoutclear("#MiscRateServiceRate", ""+MiscRateServiceRate+".00");
	Thread.sleep(100);
	wm.stabbyxpath("//input[@name='MiscRateServiceRate']");
	Thread.sleep(200);
	
	//Lodgecardd
	
	wm.sendtextbyxvalue("//input[@aria-owns='MiscOwnLodgeCardKey_listbox']",Lodgecard);
	Thread.sleep(90);
	wm.Listandenter("//*[@id='MiscOwnLodgeCardKey_listbox']/li", Commonindex);
	Thread.sleep(200);

//Enter the taxdetails
	
	// Enter the taxdetails

			wm.Listandenter("//span[@class='k-icon k-i-add']", "0");
			Thread.sleep(500);

			wm.stabbyxpath(" //span[@class='k-icon k-i-cancel']");
			Thread.sleep(200);

			// taxcodee

			wm.clickbyxpath("//span[@aria-owns='MiscTaxCodeCode_listbox']");
			Thread.sleep(50);
			wm.Listandenter("//*[@id='MiscTaxCodeCode_listbox']/li", Commonindex);
			Thread.sleep(200);

			wm.sendtextbycssselecotrwithoutclear("#MiscTaxAmount", "" + MiscTaxAmount);
			Thread.sleep(200);
			wm.clickbyxpath("//span[@class='k-icon k-i-check']");
			Thread.sleep(200);

			// enter the details in service fee

			wm.Listandenter("//span[@class='k-icon k-i-add']", "1");
			Thread.sleep(500);

//enter  service chargee
			wm.sendtextbyxvalue("//input[@aria-owns='MiscServiceChargeId_listbox']",Servicecharge);
			Thread.sleep(90);
			wm.Listandenter("//*[@id='MiscServiceChargeId_listbox']/li", Commonindex);
			Thread.sleep(200);

			wm.sendtextbycssselecotrwithoutclear("#MiscServiceFeeAmount", "" + MiscServiceFeeAmount);
			Thread.sleep(200);
			wm.clickbyxpath("//span[@class='k-icon k-i-check']");
			Thread.sleep(200);


wm.clickbyxpath("//*[@id='idSAMiscFareDev']/div/div[1]/div[1]/a/i");
Thread.sleep(200);

//enterthe commissionamount


wm.sendtextbycssselecotr("#MiscRateCommPercent1", "" + MiscRateCommPercent1);
wm.sendtextbycssselecotr("#MiscRateCommPercent2", "" + MiscRateCommPercent2);
wm.sendtextbycssselecotr("#MiscRateDiscPercent1", "" + MiscRateDiscPercent1);

Thread.sleep(200);

wm.clickbyxpath("//*[@id='idMiscCommissionAndDiscountDiv']/div/div[1]/div[1]/a/i");

Thread.sleep(500);


// Agent incentivee

wm.sendtextbyxvalue("//input[@aria-owns='MiscAgentIncentiveAccountName_listbox']", Agentincentive);
Thread.sleep(100);
wm.Listandenter("//*[@id='MiscAgentIncentiveAccountName_listbox']/li", Commonindex);
Thread.sleep(500);

wm.clickbyxpath("//*[@id='AgentIncentiveDiv']/div[1]/div[1]/a/i");
Thread.sleep(500);

// select the fop window

wm.Listandenter("//span[@class='k-icon k-i-add']", "2");
Thread.sleep(500);

wm.findbyelementbyxpathandclick("//button[@id='ConformationYes']");
Thread.sleep(900);

// ===========================================

// selected the cashoptions
wm.clickbyxpath("//span[@aria-owns='MiscFOPModeKey_listbox']");
Thread.sleep(100);
wm.Listandenter("//*[@id='MiscFOPModeKey_listbox']/li", "1");
Thread.sleep(200);

wm.clickbyxpath("//span[@aria-owns='fbbranch_listbox']");
Thread.sleep(300);
wm.sendtextbyxvalue("//input[@aria-owns='fbbranch_listbox']", Customerdetails);
Thread.sleep(200);
wm.Listandenter("//*[@id='fbbranch_listbox']/li", Commonindex);
Thread.sleep(200);

// ===============================================

wm.clickbyxpath("//span[@class='k-icon k-i-check']");
Thread.sleep(900);
wm.clickbyxpath("//*[@id='testData']/i");
Thread.sleep(500);

wm.clickbyxpath("//button[@id='btncarsave']");

Thread.sleep(500);



// Enter the udid details

wm.findelementandsendtextbycss("#Project_Number_AP", ProjectNumberAP);
Thread.sleep(50);
wm.findelementandsendtextbycss("#Department_AP", DepartmentAP);
Thread.sleep(50);
wm.findelementandsendtextbycss("#Major_Class_AP", MajorClassAP);
Thread.sleep(50);

wm.findelementandsendtextbycss("#Travel_Status_AP", TravelStatusAP);
Thread.sleep(50);
wm.findelementandsendtextbycss("#Total_Saving_Code_AP", TotalSavingCodeAP);
Thread.sleep(50);
wm.findelementandsendtextbycss("#Group_Travel_Indicator_AP", GroupTravelIndicatorAP);
Thread.sleep(50);
wm.findelementandsendtextbycss("#Tour_Code_AP", TourCodeAP);
Thread.sleep(50);
wm.findelementandsendtextbycss("#Endorsement_Restrict_AP", EndorsementRestrictAP);
Thread.sleep(50);
wm.findelementandsendtextbycss("#Fare_Calculation_Area_AP", FareCalculationAreaAP);
Thread.sleep(200);
wm.clickbyxpath("//span[@aria-owns='Booking_Type_AP_listbox']");
Thread.sleep(200);
wm.Listandenter("//*[@id='Booking_Type_AP_listbox']/li", Commonindex);
Thread.sleep(200);

wm.findelementandsendtextbycss("#Intl_Sales_Indicator_AP", IntlSalesIndicatorAP);
Thread.sleep(200);
wm.findbyelementbyxpathandclick("//button[@id='btncarsave']");
Thread.sleep(50);

Thread.sleep(16000);

		wm.sleep();

	}

	@AfterMethod
	public void close()

	{
		wm.close();

	}

	@DataProvider(name = "dp")
	public Object[][] dp() throws IOException {

		return Wrappermethods.getSheet("Misccash", "Misccash");

	}
}