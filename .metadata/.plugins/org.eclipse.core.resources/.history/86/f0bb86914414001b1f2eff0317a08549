//WASTA login screen
package travlogix;

import utility.Constant;
import java.io.IOException;
import java.sql.Driver;
import java.util.ArrayList;
import org.testng.annotations.AfterMethod;
import org.testng.annotations.BeforeMethod;
import org.testng.annotations.BeforeTest;
import org.testng.annotations.DataProvider;
import org.testng.annotations.Listeners;
import org.testng.annotations.Test;
import travlogix.Wrappermethods;
import atu.testng.reports.listeners.ATUReportsListener;
import atu.testng.reports.listeners.ConfigurationListener;
import atu.testng.reports.listeners.MethodListener;

@Listeners({ ATUReportsListener.class, ConfigurationListener.class, MethodListener.class })
public class Agentincentive {

	static {

		// System.setProperty("atu.reporter.config",
		// "C:\\ATUReports\\atu.properties");
		System.setProperty("atu.reporter.config", utility.Constant.ATUREPORTS);

	}

	Wrappermethods wm;

	@BeforeTest
	public void instantiation() {
		wm = new Wrappermethods();

	}

	@BeforeMethod
	public void browesrnstatiation()

	{

		wm.launchbrowser("chrome", utility.Constant.TRAVELOGIXURL);

	}

	@Test(dataProvider = "dp")
	public void logincheckK(String Username, String Password, String Leftsidemenu) throws Exception

	{

		Thread.sleep(2000);

		// wm.sendtextbyid("", );
		wm.sendtextbyid("LoginCode", Username);
		Thread.sleep(200);
		wm.sendtextbyid("Password", Password);
		Thread.sleep(200);
		wm.clickbyxpath("//input[@value='Login']");
		wm.sleep();

		// screnn===========================================================
		wm.sendtextbyid("input-items", Leftsidemenu);
		Thread.sleep(500);
		wm.clickbyid("modMAS001");
		Thread.sleep(500);
		wm.clickbyid("pgmBR001");
		wm.sleep();

		// Start enter thecodee

		wm.sendtextbycssselecotrwithoutclear("#Code", Code);
		wm.sendtextbycssselecotrwithoutclear("#Description", Description);
		wm.sendtextbycssselecotrwithoutclear("#AtaiAddress", AtaiAddress);
		wm.sendtextbycssselecotrwithoutclear("#AtaiBankAc", AtaiBankAc);

		// enterthe customername and indexx
		wm.sendtextbyxvalue("//input[@aria-owns='AtaiCmsKey_listbox']", Customername);
		Thread.sleep(200);
		wm.Listandenter("//*[@id='AtaiCmsKey_listbox']/li", Customernameindex);
		Thread.sleep(200);

		// enterthe customername and indexx
		wm.sendtextbyxvalue("//input[@aria-owns='AtaiType_listbox']", Agentincetive);
		Thread.sleep(200);
		wm.Listandenter("//*[@id='AtaiType_listbox']/li", Agentincetiveindex);
		Thread.sleep(200);

		// Agent status
		wm.sendtextbyxvalue("//input[@aria-owns='AStatus_listbox']", Agentstatus);
		Thread.sleep(200);
		wm.Listandenter("//*[@id='AStatus_listbox']/li", Agentstatusindex);
		Thread.sleep(200);

		// Effectivedate

		wm.sendtextbycssselecotr("#AtaiEffectiveDate",
				"" + AtaiEffectiveDate1 + "-" + AtaiEffectiveDate2 + "-" + AtaiEffectiveDate3);

		// Accountlinkk
		wm.sendtextbyxvalue("//input[@aria-owns='AtaiAccountLink_listbox']", Accountlink);
		Thread.sleep(200);
		wm.Listandenter("//*[@id='AtaiAccountLink_listbox']/li", Accountlinkindexx);
		Thread.sleep(200);

		// Valuetypee
		wm.sendtextbyxvalue("//input[@aria-owns='AtaiValueType_listbox']", Valuetype);
		Thread.sleep(200);
		wm.Listandenter("//*[@id='AtaiValueType_listbox']/li", Valuetypeindex);
		Thread.sleep(200);

		// enterthe value
		wm.stabbyxpath("//input[@aria-owns='AtaiValueType_listbox']");
		Thread.sleep(200);
		wm.sendtextbycssselecotrwithoutclear("#AtaimPercentage", ""+AtaimPercentage);
		Thread.sleep(200);

		wm.clickbyxpath("//span[@class='k-icon k-i-check']");
		Thread.sleep(500);
		
		wm.Verifythealertpopupmessages("//*[@id='diaInfoMessage']",
				"Agent Incentive Saved/Updated Successfully",
				"Agent Incentive Created successfully",
				"Agent incentive not Created Successfully");

		
		wm.sleep();
	}

	@AfterMethod
	public void close()

	{
		wm.close();

	}

	@DataProvider(name = "dp")
	public Object[][] dp() throws IOException {

		return Wrappermethods.getSheet("Branchmasternegativescenarios", "Branchmasternegativescenarios");

	}
}